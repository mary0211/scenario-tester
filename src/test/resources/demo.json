{
arguments:{
	threads:200,	
	thread-step:1,
	secnerio-term:5000,
	loop:20,
},
variables:{
	mrs-was-host:"54.238.214.31:10481",
	think-user-time:10,
	wait-a-term:200,
	rowemid-prefix:"usr",
	service-code:"md",
	dcp-version:"1.0",
	dcp-password:"asdf",
	servername-mrs:"devmrs2",
	servername-mps:"devmps2",
	loop-count:100,
	transaction-count:0,
	monitoring-term:1000
},
body:{
prolog:[
		["Post", "mrs-was-host", "/test/removedata",
		"rowemid={{rowemid-prefix}}&count={{threads}}&servicecode={{service-code}}&version={{dcp-version}}&password={{dcp-password}}","0"]
		,
		["Post", "mrs-was-host", "/test/createdata",
		"rowemid={{rowemid-prefix}}&count={{threads}}&servicecode={{service-code}}&version={{dcp-version}}&password={{dcp-password}}"
		,"0"],
		["Monitor", "monitor", "{\"term\":\"{{monitoring-term}}\", \"local-variables\":[\"request-count\", \"sum-of-response-time\"], \"format\":[\"{{SECONDS}}\", \"{{request-count}}\", [\"CalculateVariable\", \"\", \"/\", \"{{sum-of-response-time}}\", \"1000\"], [\"CalculateVariable\", \"\", \"/\", \"{{request-count}}\", \"{{sum-of-response-time}}\", \"0.001\"]]}"],
		["OpenFile", "request", "request.log"],
		["OpenFile", "response", "response.log"],
		["OpenFile", "request-message", "requestmessage.log"],
		["OpenFile", "request-message-success", "requestMessageSuccess.log"],
		["OpenFile", "request-message-fail", "requestMessageFail.log"]
	],
scenes:
	[	
		["Concatenate", "rowemid", "{{rowemid-prefix}}", "{{THREAD-ID}}"],
		["Concatenate", "service-id", "{{rowemid}}", "#servername/", "{{service-code}}","/","{{dcp-version}}"],
		["Concatenate", "pcid", "{{rowemid}}"],
		["Concatenate", "packetid", "{{service-id}}", ".", "{{pcid}}"],
		["Concatenate", "pctoken", "{{rowemid}}"],
		["Concatenate", "servicetoken", "{{rowemid}}"],
		["Concatenate", "keepalivetoken", "{{rowemid}}"],
		["CalculateVariable", "wait-a", "*", "{{THREAD-ID}}", "{{wait-a-term}}"],
		["Wait", "wait-a"],
		["OpenChannel", "ch-mrs", "54.238.214.31:10401"],
		["OpenChannel", "ch-mps", "54.238.214.31:10702"],

		["IncreaseGlobal", "request-idx", "1"],
		["Concatenate", "request-time", ["Timestamp"]],
		["WriteToFile", "request", "{{request-idx}}", "{{request-time}}", ["SendToChannel", "ch-mrs", "CMN00001{\"packetid\":\"{{packetid}}\"}"]],
		["Concatenate", "response-message", ["ReceiveFromChannel", "ch-mrs", "\"resultcode\":\"0\"", "0"]],
		["Concatenate", "response-time", ["Timestamp"]],
		["CalculateVariable", "term", "-", "{{response-time}}", "{{request-time}}"],
		["WriteToFile", "response", "{{request-idx}}", "{{response-time}}", "{{term}}", "{{response-message}}"],

		["IncreaseGlobal", "request-idx", "1"],
		["Concatenate", "request-time", ["Timestamp"]],
		["WriteToFile", "request", "{{request-idx}}", "{{request-time}}", ["SendToChannel", "ch-mps", "KAP00001{\"keepalivetoken\":\"{{keepalivetoken}}\"}"]],
		["Concatenate", "response-message", ["ReceiveFromChannel", "ch-mps", "\"resultcode\":\"0\"", "0"]],
		["Concatenate", "response-time", ["Timestamp"]],
		["CalculateVariable", "term", "-", "{{response-time}}", "{{request-time}}"],
		["WriteToFile", "response", "{{request-idx}}", "{{response-time}}", "{{term}}", "{{response-message}}"],

		["IncreaseGlobal", "request-idx", "1"],
		["Concatenate", "request-time", ["Timestamp"]],
		["WriteToFile", "request", "{{request-idx}}", "{{request-time}}", "/test/bindingmrs", "packetid={{packetid}}&servername={{servername-mrs}}&cntl=I"],
		["Concatenate", "response-message", ["Post", "mrs-was-host", "/test/bindingmrs", "packetid={{packetid}}&servername={{servername-mrs}}&cntl=I", "1"]],
		["Concatenate", "response-time", ["Timestamp"]],
		["CalculateVariable", "term", "-", "{{response-time}}", "{{request-time}}"],
		["WriteToFile", "response", "{{request-idx}}", "{{response-time}}", "{{term}}", "{{response-message}}"],

		["IncreaseGlobal", "request-idx", "1"],
		["Concatenate", "request-time", ["Timestamp"]],
		["WriteToFile", "request", "{{request-idx}}", "{{request-time}}", "/test/bindingmps", "serviceid={{service-id}}&servername={{servername-mps}}&cntl=I"],
		["Concatenate", "response-message", ["Post", "mrs-was-host", "/test/bindingmps", "serviceid={{service-id}}&servername={{servername-mps}}&cntl=I", "1"]],	
		["Concatenate", "response-time", ["Timestamp"]],
		["CalculateVariable", "term", "-", "{{response-time}}", "{{request-time}}"],
		["WriteToFile", "response", "{{request-idx}}", "{{response-time}}", "{{term}}", "{{response-message}}"],

		["IncreaseGlobal", "request-idx", "1"],
		["Concatenate", "request-time", ["Timestamp"]],
		["WriteToFile", "request", "{{request-idx}}", "{{request-time}}", "/servicemd/service/reqdirectory", "packetid={{packetid}}&upfolder=home&rowemid={{rowemid}}&servicetoken={{servicetoken}}"],
		["WriteToFile", "request-message", "{{request-idx}}", "{{request-time}}", "{{rowemid}}"],
		["Concatenate", "response-post", ["Post", "54.238.214.31:8081", "/servicemd/service/reqdirectory", "packetid={{packetid}}&upfolder=home&rowemid={{rowemid}}&servicetoken={{servicetoken}}", "0"]],
		["Concatenate", "response-mrs", ["ReceiveFromChannel", "ch-mrs", "\"upfolder\":", "0"]],
		["Concatenate", "response-time", ["Timestamp"]],
		["CalculateVariable", "term", "-", "{{response-time}}", "{{request-time}}"],
		["WriteToFile", "response", "{{request-idx}}", "{{response-time}}", "{{term}}", "{{response-post}}"],
		["WriteToFile", "response", "{{request-idx}}", "{{response-time}}", "{{term}}", "{{response-mrs}}"],
		["If", ["Equals", "sucess", "{{response-mrs}}"], 
			["WriteToFile", "request-message-success", "{{request-idx}}", "{{response-time}}", "{{rowemid}}"],
			["WriteToFile", "request-message-fail", "{{request-idx}}", "{{response-time}}", "{{rowemid}}"],
		],
		["IncreaseGlobal", "request-count", "1"],
		["IncreaseGlobal", "sum-of-response-time", "{{term}}"],

		["IncreaseGlobal", "request-idx", "1"],
		["Concatenate", "request-time", ["Timestamp"]],
		["WriteToFile", "request", "{{request-idx}}", "{{request-time}}", "/servicemd/service/resdirectory", "packetid={{packetid}}&rowemid={{rowemid}}&upfolder=home&fileinfo=1&pctoken={{pctoken}}"],
		["WriteToFile", "request-message", "{{request-idx}}", "{{request-time}}", "{{rowemid}}"],
		["Concatenate", "response-post", ["Post", "54.238.214.31:10481", "/servicemd/service/resdirectory", "packetid={{packetid}}&rowemid={{rowemid}}&upfolder=home&fileinfo=1&pctoken={{pctoken}}", "1"]],
		["Concatenate", "response-mps", ["ReceiveFromChannel", "ch-mps", "\"", "0"]],
		["Concatenate", "response-time", ["Timestamp"]],
		["CalculateVariable", "term", "-", "{{response-time}}", "{{request-time}}"],
		["WriteToFile", "response", "{{request-idx}}", "{{response-time}}", "{{term}}", "{{response-post}}"],
		["WriteToFile", "response", "{{request-idx}}", "{{response-time}}", "{{term}}", "{{response-mps}}"],
		["If", ["Equals", "sucess", "{{response-mps}}"], 
			["WriteToFile", "request-message-success", "{{request-idx}}", "{{response-time}}", "{{rowemid}}"],
			["WriteToFile", "request-message-fail", "{{request-idx}}", "{{response-time}}", "{{rowemid}}"],
		],
		["IncreaseGlobal", "request-count", "1"],
		["IncreaseGlobal", "sum-of-response-time", "{{term}}"],
		["IncreaseGlobal", "transaction-count", "1"],

		["CloseChannel", "ch-mps"],
		["CloseChannel", "ch-mrs"],
	],
epilogue:[
		["Post", "mrs-was-host", "/test/removedata",
		"rowemid={{rowemid-prefix}}&count={{threads}}&servicecode={{service-code}}&version={{dcp-version}}&password={{dcp-password}}","0"],
	]
}

}
